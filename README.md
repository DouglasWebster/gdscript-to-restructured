# GDScript reStructuredText Docs Maker

This is a tool to document your Godot gdscript files into ***re*****Structured*****Text*** (..rst) files and to create an index of the generated files if required.

The code is based on the [gdscript-docs-maker code](https://github.com/GDQuest/gdscript-docs-maker) from [**GDQuest**](https://www.gdquest.com/) and, in as far as the initial stages of the conversion are concerned, it is a direct copy of their code with a few notable exceptions:
- This version only provides ***re*****Structured*****Text*** (.rst) output - if you require markdown or Hugo output then please follow the above link and use the original version.
- As there is no facility to create markdown or Hugo files the `-f/--format` and  `-a/--author` options in the original are no longer available.
- Multi-line comments in the code are concatenated to single line comments unless there are multiple  line breaks, in which case the line breaks are preserved.  This is to give, hopefully, a better flow of the description text.

## Installation

No installation is necessary if this is a fork of the repository otherwise you should install gdscript2rest from [PyPI](https://pypi.org)
 ## Additional requirements

In order to make the links from the Godot class names to the Godot API help files a link file has to be created and available to in the working directory of the program.  This can be accomplished by installing a small utility [godot-api-refs](https://pypi.org/project/godot-api-refs/) and running it in from the current working directory.

---
## Usage

The generation of the ***re*****Structured*****Text*** files is a two step process.

1. Create a JSON file that contains all the information extracted from your Godot project script files.
2. Turn each of the separate classes in the JSON file that contains a class_name qualifier into a separate ***re*****Structured*****Text*** file.


## Stage 1 - Create the JSON file

This is accomplished using the scripts available at [GDQuest gdscript-docs-maker](https://github.com/GDQuest/gdscript-docs-maker/tree/master/godot-scripts).  A copy of them is available in this repository under the godot-scripts folder but there is no guarantee that these scripts are up to date. For the latest use and for detailed instructions please refer to the original source repository.

Also included in this repository is the script generate_reference.  This is a bash script which has been copied from the GDQuest repository but has been altered to stop at producing the .json file. To use it enter
```
generate_reference $Godot-Project-Directory [options]
```
to create a file ***reference.json*** in the current working directory of your game project located in the ***$Godot-Project-Directory***

Run
```
generate_reference -h
```
To see a list of the options.  Please note that the -a and -f options do nothing in the enclosed version of the script.


## Stage 2 - Create the reStructuredText documents

To create the ***re*****Structured*****Text*** documents it is sufficient to run

``` 
python -m gdscript2rest $ReferenceFile.json
```
where $ReferenceFile.json is the path to the file created in Stage 1.  The program will output the files in a subdirectory called ***export***.

If you run 
```
python -m gdscript2rest -h
```

it will display the following which lists the options available to the program.
```
usage: gdscript2rest [-h] [-p PATH] [-i] [-v] [--dry-run] [-V] files [files ...]

Converts JSON data dumped by Godot's GDScript language server to create .rst files for 
use with Sphinx.

positional arguments:
  files                 A list of paths to JSON files.

optional arguments:
  -h, --help            show this help message and exit
  -p PATH, --path PATH  Path to the output directory.
  -i, --make-index      If this flag is present, create an index.rst page with a table of contents.
  -v, --verbose         Set the verbosity level. For example -vv sets verbosity to level 2. 
                        (Default: 0.)
  --dry-run             Run the script at max verbosity without creating files.
                        (For debugging purposes.)
  -V, --version         Print the version number and exit,
 --doc-version DOC_VERSION
                        Set the document version number if there is no version set in the JSON file. 
                        Defaults to 0.0.0
 ```

A fuller explanation of the options is:

* files :-> this is a list of files generated by ***generate-reference*** that is used as the input to the program
* -h --help :-> prints out the above usage statement and exits.
* -p PATH, --path PATH :-> outputs the reStructuredText files to PATH, this can be either an absolute or relative path
* -i :-> Creates an index file ***index.rst***.  This file is a very basic file with a single toctree entry that globs all the files in its directory
*  -v, --verbose :-> Prints out information as the program progresses.  Not over helpful but could aid in finding problems.
* --dry-run             Run the script at max verbosity without creating files. (For debugging purposes.)
*  -V, --version         Print the version number and exit,
* --doc-version DOC_VERSION :-> Unless I'm missing something Godot doesn't currently have the facility to store a version number so this gives the option to set the version number manually.  If not used the version number defaults to 0.0.0

## Further Information

For additional information and a brief tutorial on how to use the ***re*****Structured*****Text*** files to create a Sphinx documents site see the [Wiki](https://github.com/DouglasWebster/gdscript-to-restructured/wiki) section of this repository.

## Acknowledgements

My thanks to the people at [**GDQuest**](https://www.gdquest.com/) for providing the initial program from which this was derived and to the people at [Godot](https://godotengine.org/) for putting all there hard work out there for us to use.